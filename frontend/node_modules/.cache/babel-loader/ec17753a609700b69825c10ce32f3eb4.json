{"ast":null,"code":"var _jsxFileName = \"F:\\\\pushPullLab2\\\\chat-app-using-push-and-pull-technology-master\\\\frontend\\\\src\\\\ws.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from \"react\";\nimport './ws.css';\nimport io from 'socket.io-client'; // connect on the server\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst serverUrl = \"http://localhost:3000\";\nconst socket = io.connect(serverUrl);\n\nconst WS = () => {\n  _s();\n\n  const inputRef = useRef();\n  const messagesRef = useRef();\n  const [messages, setMessages] = useState([]); // chat\n\n  const [clients, setClients] = useState([]); // list of online clients\n\n  const [clientId, setClientId] = useState(''); // who i chat with\n\n  const submitHandler = e => {\n    e.preventDefault();\n\n    if (clientId) {\n      socket.emit('chat specific client', clientId, socket.id, inputRef.current.value);\n      inputRef.current.value = '';\n    }\n  };\n\n  useEffect(() => {\n    socket.on('init clients list', clientIds => {\n      const clietsWithoutMe = clientIds.filter(client => client !== socket.id);\n      setClients(clietsWithoutMe);\n    });\n    socket.on('connect specific client', socketId => {\n      setClientId(socketId);\n    });\n    socket.on('chat specific client message', function (msg) {\n      setMessages(prev => [...prev, msg]);\n    });\n    socket.on('group chat message', function (msg) {\n      setMessages(prev => [...prev, msg]);\n    });\n    socket.on('group chat clients', function (msg) {\n      setClients(prev => [...prev, msg]);\n      console.log('sockedid to add ', msg);\n    });\n  }, []);\n\n  const handleClickClient = clientId => {\n    setClientId(clientId);\n    socket.emit('connect specific client', clientId, socket.id);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Private chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        ref: messagesRef,\n        id: \"messages\",\n        children: clients.map(client => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleClickClient(client),\n            children: client\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 92\n          }, this)\n        }, Math.ceil(Math.random() * 10000), false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 49\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n        ref: messagesRef,\n        id: \"messages\",\n        children: messages.map(message => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: message\n        }, Math.ceil(Math.random() * 10000), false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 51\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        id: \"form\",\n        onSubmit: submitHandler,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"Enter your message\",\n          id: \"input\",\n          ref: inputRef,\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 9\n  }, this);\n};\n\n_s(WS, \"xVtGEJ/tcOtAD/4p/QhQ0zamJ3E=\");\n\n_c = WS;\nexport default WS;\n\nvar _c;\n\n$RefreshReg$(_c, \"WS\");","map":{"version":3,"names":["React","useEffect","useState","useRef","io","serverUrl","socket","connect","WS","inputRef","messagesRef","messages","setMessages","clients","setClients","clientId","setClientId","submitHandler","e","preventDefault","emit","id","current","value","on","clientIds","clietsWithoutMe","filter","client","socketId","msg","prev","console","log","handleClickClient","map","Math","ceil","random","message"],"sources":["F:/pushPullLab2/chat-app-using-push-and-pull-technology-master/frontend/src/ws.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\"\nimport './ws.css';\nimport io from 'socket.io-client';\n\n// connect on the server\nconst serverUrl = \"http://localhost:3000\";\nconst socket = io.connect(serverUrl);\n\nconst WS = () =>{\n    const inputRef = useRef();\n    const messagesRef = useRef();\n    const [messages, setMessages] = useState([]); // chat\n    const [clients, setClients] = useState([]); // list of online clients\n    const [clientId, setClientId] = useState(''); // who i chat with\n\n    const submitHandler = (e) =>{\n        e.preventDefault();\n        if (clientId) {\n            socket.emit('chat specific client', clientId, socket.id, inputRef.current.value);\n            inputRef.current.value = ''; \n        }\n    }\n\n    useEffect(() =>{\n        socket.on('init clients list', (clientIds) => {\n            const clietsWithoutMe = clientIds.filter(client => client !== socket.id);\n            setClients(clietsWithoutMe);\n        })\n        socket.on('connect specific client', (socketId) => {\n            setClientId(socketId);\n          });\n        socket.on('chat specific client message', function(msg) {\n            setMessages((prev) => [...prev, msg]);\n          });\n        socket.on('group chat message', function(msg) {\n            setMessages((prev) => [...prev, msg])\n          });\n        socket.on('group chat clients', function(msg) {\n            setClients((prev) => [...prev, msg]);\n            console.log('sockedid to add ', msg);\n          });\n          \n    }, [])\n\n    const handleClickClient = (clientId) =>{\n        setClientId(clientId);\n        socket.emit('connect specific client', clientId, socket.id);\n    }\n\n    return(\n        <div className=\"container\">\n            <aside >\n                <h2>Private chat</h2>\n                <ul ref={messagesRef} id=\"messages\">\n                    {\n                        clients.map((client) => <li key={Math.ceil(Math.random() * 10000)}><button onClick={()=>handleClickClient(client)}>{client}</button></li>)\n                    }\n                </ul>\n            </aside>\n            <section >\n                <ul ref={messagesRef} id=\"messages\">\n                    {\n                        messages.map((message) => <li key={Math.ceil(Math.random() * 10000)}>{message}</li>)\n                    }\n                </ul>\n                <form id=\"form\" onSubmit={submitHandler}>\n                    <input \n                        placeholder=\"Enter your message\" \n                        id=\"input\" \n                        ref={inputRef} \n                        required\n                    />\n                    <button>Send</button>\n                </form>\n            </section>\n        </div>\n    )\n} \n\n\nexport default WS;"],"mappings":"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"},"metadata":{},"sourceType":"module"}